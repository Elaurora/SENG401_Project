<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Auroras.live | Manage Configuration</title>
</head>
<style>
    html {
        background: #dddddd;
    }
    h1 {
        text-align: center;
        font-family: Arial;
        font-size: 40px;
        font-weight: normal;
        font-style: italic;
        color: white;
        text-shadow: #bbbbbb 3px 2px;
    }
    p {
        width: 50%;
        text-align: justify;
        font-family: Arial;
    }
    table {
        width: 50%;
        font-family: Arial;
        border-collapse: collapse;
    }
    th {
        text-align: left;
    }
</style>
<body onload="buildRuleTable('#sampleLocalTable'); buildVarTable('#sampleMatchVarTable')">
<h1>Auroras.live | Manage Configuration</h1>
<div style="background: white; width: 60%; margin-left: 20%; margin-right: 20%; align-content: center; border-radius: 10px">
    <br/>
    <div align="center" style="margin: 5%">

        <div style="width: 50%; font-family: Arial; font-weight: bold">
            Local Cache Rules
        </div>
        <table id="sampleLocalTable" border="1"></table>
        <br/>
        <button id="newCacheRuleButton">New Cache Rule</button>
        <button id="deleteCacheRuleButton">Delete Cache Rule</button>
        <br/>
        <br/>
        <div style="width: 50%; font-family: Arial; font-weight: bold">
            Variable Rules
        </div>
        <table id="sampleMatchVarTable" border="1"></table>
        <br/>
        <button id="newVarRuleButton">New Variable Rule</button>
        <button id="deleteVarRuleButton">Delete Variable Rule</button>
        <br/>
        <p>
            Above are all the current caching rules for this node server! Press <i>New ___ Rule</i>
            to add a new rule to a table, press <i>Delete ___ Rule</i> to delete a rule, or press
            <i>Back</i> to go back to the main page.
        </p>
        <button id="backButton">Back</button>

        <!-- Form for "New Cache Rule" -->

        <div id="newCacheRuleFormParent" style="display: none; position: fixed; width: 100%; height: 100%; top: 0; left: 0; background-color: rgba(0, 0, 0, 0.5)">
            <div id="newCacheRuleForm" style="position: absolute; left: 40%; top: 17%; opacity: 1.0">
                <form action="/SENG401/config/submit/manageconfig/newcacherule" method="post" style="background: white; max-width: 300px; min-width: 250px; padding: 15px; border: 1px solid black; border-radius: 10px; opacity: 1">
                    <p style="width: 100%; margin-left: 10%">
                        <b>New Cache Rule</b>
                        <br/>
                        <br/>
                        rule_id:<br/>
                        <input name="rule_id" type="text">
                        <br/>
                        local_ttl:<br/>
                        <input name="local_ttl" type="text">
                        <br/>
                        global_ttl:<br/>
                        <input name="global_ttl" type="text">
                        <br/>
                        <br/>
                        <br/>
                        <button id="submitNewCacheRuleForm" type="submit">Submit</button>
                        <button id="cancelNewCacheRuleForm" type="reset">Cancel</button>
                    </p>
                </form>
            </div>
        </div>

        <!-- Form for "Delete Cache Rule" -->

        <div id="deleteCacheRuleFormParent" style="display: none; position: fixed; width: 100%; height: 100%; top: 0; left: 0; background-color: rgba(0, 0, 0, 0.5)">
            <div id="deleteCacheRuleForm" style="position: absolute; left: 40%; top: 17%; opacity: 1.0">
                <form action="/SENG401/config/submit/manageconfig/deletecacherule" method="post" style="background: white; max-width: 300px; min-width: 250px; padding: 15px; border: 1px solid black; border-radius: 10px; opacity: 1">
                    <p style="width: 100%; margin-left: 10%">
                        <b>Delete Cache Rule</b>
                        <br/>
                        <br/>
                        rule_id:<br/>
                        <input name="rule_id" type="text">
                        <br/>
                        <br/>
                        <br/>
                        <button id="submitDeleteCacheRuleForm" type="submit">Submit</button>
                        <button id="cancelDeleteCacheRuleForm" type="reset">Cancel</button>
                    </p>
                </form>
            </div>
        </div>

        <!-- Form for "New Var Rule" -->

        <div id="newVarRuleFormParent" style="display: none; position: fixed; width: 100%; height: 100%; top: 0; left: 0; background-color: rgba(0, 0, 0, 0.5)">
            <div id="newVarRuleForm" style="position: absolute; left: 40%; top: 17%; opacity: 1.0">
                <form action="/SENG401/config/submit/manageconfig/newvariablerule" method="post" style="background: white; max-width: 300px; min-width: 250px; padding: 15px; border: 1px solid black; border-radius: 10px; opacity: 1">
                    <p style="width: 100%; margin-left: 10%">
                        <b>New Variable Rule</b>
                        <br/>
                        <br/>
                        rule_id:<br/>
                        <input name="rule_id" type="text">
                        <br/>
                        var_type:<br/>
                        <input name="var_type" type="text">
                        <br/>
                        var_value:<br/>
                        <input name="var_value" type="text">
                        <br/>
                        <br/>
                        <br/>
                        <button id="submitNewVarRuleForm" type="submit">Submit</button>
                        <button id="cancelNewVarRuleForm" type="reset">Cancel</button>
                    </p>
                </form>
            </div>
        </div>

        <!-- Form for "Delete Var Rule" -->

        <div id="deleteVarRuleFormParent" style="display: none; position: fixed; width: 100%; height: 100%; top: 0; left: 0; background-color: rgba(0, 0, 0, 0.5)">
            <div id="deleteVarRuleForm" style="position: absolute; left: 40%; top: 17%; opacity: 1.0">
                <form action="/SENG401/config/submit/manageconfig/deletevariablerule" method="post" style="background: white; max-width: 300px; min-width: 250px; padding: 15px; border: 1px solid black; border-radius: 10px; opacity: 1">
                    <p style="width: 100%; margin-left: 10%">
                        <b>Delete Variable Rule</b>
                        <br/>
                        <br/>
                        rule_id:<br/>
                        <input name="rule_id" type="text">
                        <br/>
                        var_type:<br/>
                        <input name="var_type" type="text">
                        <br/>
                        var_value:<br/>
                        <input name="var_value" type="text">
                        <br/>
                        <br/>
                        <br/>
                        <button id="submitDeleteVarRuleForm" type="submit">Submit</button>
                        <button id="cancelDeleteVarRuleForm" type="reset">Cancel</button>
                    </p>
                </form>
            </div>
        </div>
    </div>
    <br/>
</div>
</body>
</html>

<!-- This next part is shamelessly ripped from stackoverflow... -->
<!-- This is ultimately only here to give a better idea of what this page should look like. -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
<script>
    var cacheRulesList = [
        { "rule_id": 0, "local_ttl" : 50, "global_ttl": 50 },
        { "rule_id": 1, "local_ttl" : 50, "global_ttl": 50 },
        { "rule_id": 2, "local_ttl" : 50, "global_ttl": 50 },
        { "rule_id": 3, "local_ttl" : 50, "global_ttl": 50 },
        { "rule_id": 4, "local_ttl" : 50, "global_ttl": 50 }
    ];

    var matchVarRulesList = [
        { "rule_id": 0, "var_type" : "locations", "var_value": "yellowknife" },
        { "rule_id": 1, "var_type" : "locations", "var_value": "yellowknife" },
        { "rule_id": 2, "var_type" : "locations", "var_value": "yellowknife" },
        { "rule_id": 3, "var_type" : "locations", "var_value": "yellowknife" },
        { "rule_id": 4, "var_type" : "locations", "var_value": "yellowknife" }
    ];

    function buildRuleTable(selector) {
        var columns = addAllColumnHeaders(cacheRulesList, selector);

        for (var i = 0; i < cacheRulesList.length; i++) {
            var row$ = $('<tr/>');
            for (var colIndex = 0; colIndex < columns.length; colIndex++) {
                var cellValue = cacheRulesList[i][columns[colIndex]];
                if (cellValue == null) cellValue = "";
                row$.append($('<td/>').html(cellValue));
            }
            $(selector).append(row$);
        }
    }

    <!-- Code reuse? What the hell is that? -->

    function buildVarTable(selector) {
        var columns = addAllColumnHeaders(matchVarRulesList, selector);

        for (var i = 0; i < matchVarRulesList.length; i++) {
            var row$ = $('<tr/>');
            for (var colIndex = 0; colIndex < columns.length; colIndex++) {
                var cellValue = matchVarRulesList[i][columns[colIndex]];
                if (cellValue == null) cellValue = "";
                row$.append($('<td/>').html(cellValue));
            }
            $(selector).append(row$);
        }
    }

    function addAllColumnHeaders(myList, selector) {
        var columnSet = [];
        var headerTr$ = $('<tr/>');

        for (var i = 0; i < myList.length; i++) {
            var rowHash = myList[i];
            for (var key in rowHash) {
                if ($.inArray(key, columnSet) == -1) {
                    columnSet.push(key);
                    headerTr$.append($('<th/>').html(key));
                }
            }
        }
        $(selector).append(headerTr$);

        return columnSet;
    }

    <!-- For "New Cache Rule"... -->

    document.getElementById("newCacheRuleButton").onclick = function () {
        document.getElementById('newCacheRuleFormParent').style.display = "block";
    };

    document.getElementById("submitNewCacheRuleForm").onclick = function () {
        document.getElementById('newCacheRuleFormParent').style.display = "none";
    };

    document.getElementById("cancelNewCacheRuleForm").onclick = function () {
        document.getElementById('newCacheRuleFormParent').style.display = "none";
    };

    <!-- For "Delete Cache Rule"... -->

    document.getElementById("deleteCacheRuleButton").onclick = function () {
        document.getElementById('deleteCacheRuleFormParent').style.display = "block";
    };

    document.getElementById("submitDeleteCacheRuleForm").onclick = function () {
        document.getElementById('deleteCacheRuleFormParent').style.display = "none";
    };

    document.getElementById("cancelDeleteCacheRuleForm").onclick = function () {
        document.getElementById('deleteCacheRuleFormParent').style.display = "none";
    };

    <!-- For "New Var Rule"... -->

    document.getElementById("newVarRuleButton").onclick = function () {
        document.getElementById('newVarRuleFormParent').style.display = "block";
    };

    document.getElementById("submitNewVarRuleForm").onclick = function () {
        document.getElementById('newVarRuleFormParent').style.display = "none";
    };

    document.getElementById("cancelNewVarRuleForm").onclick = function () {
        document.getElementById('newVarRuleFormParent').style.display = "none";
    };

    <!-- For "Delete Var Rule"... -->

    document.getElementById("deleteVarRuleButton").onclick = function () {
        document.getElementById('deleteVarRuleFormParent').style.display = "block";
    };

    document.getElementById("submitDeleteVarRuleForm").onclick = function () {
        document.getElementById('deleteVarRuleFormParent').style.display = "none";
    };

    document.getElementById("cancelDeleteVarRuleForm").onclick = function () {
        document.getElementById('deleteVarRuleFormParent').style.display = "none";
    };

    <!-- For "Back"... -->

    document.getElementById("backButton").onclick = function () {
        location.href = "/SENG401/CacheConfigFrontend/CacheConfigGUI/CacheConfigurator.html";
    };
</script>
